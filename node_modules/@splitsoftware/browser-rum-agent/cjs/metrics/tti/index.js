"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.tti = void 0;
var tti_polyfill_1 = require("./tti-polyfill");
var log_1 = require("../../utils/log");
/**
 * Collects Time-to-Interactive metric.
 */
function tti() {
    return function (ctx) {
        if (!('Promise' in window)) {
            log_1.log.error('Promise API is not supported. Time-to-Interactive metric will not be collected.');
            return;
        }
        try {
            (0, tti_polyfill_1.ttiPolyfill)().getFirstConsistentlyInteractive().then(function (tti) {
                if (typeof tti === 'number') {
                    ctx.track({
                        eventTypeId: 'time.to.interactive',
                        value: tti,
                    });
                }
            }).catch(function () { });
        }
        catch (e) {
            log_1.log.error('Failed to collect Time-to-Interactive metric. ' + e);
        }
    };
}
exports.tti = tti;
